<html>
<head>
  <meta charset="UTF-8">
  <title>StringTools</title>
  <script src="../../node_modules/jquery/dist/jquery.js"></script>
  <link rel="stylesheet" type="text/css" href="../../css/common.css">
  <style>
    html, body, div, span, label {
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    .toolOption .toggleButton {
      background-color: #0bf9cb;
    }
    .toolPanel {
      display: flex;
      flex-flow: row nowrap;
      justify-content: space-between;
      align-items: stretch;
      width: 100%;
    }
    .toolPanel >.flexElement {
      flex: 0 0;
      flex-basis: calc(40% - 20px);
      display: flex;
      flex-flow: column nowrap;
      justify-content: flex-start;
      align-items: flex-start;
      margin: 0 10px;
    }
    .toolPanel >.flexElement > textarea {
      height: 400px;
      width: 100%;
    }
    .controlFlexContainer {
      flex: 0 0;
      flex-basis: 20%;
      display: flex;
      flex-flow: column nowrap;
      justify-content: space-around;
      align-items: flex-start;
      width: 100%;
      margin: 10px 0;
      background-color: transparent;
    }
    .controlOption {
      flex: 0 0 auto;
      display: flex;
      flex-flow: row nowrap;
      justify-content: space-around;
      align-items: center;
      width: 80%;
      margin: 0 10%;
    }
    .controlFlexContainer > hr {
      width: 100%;
    }
    .controlOption label {
      width: 80%;
      flex: 1 1 80%;
    }
    .controlOption input[type="checkbox"] {
      flex: 0 0 10%;
    }
    .controlOption input[type="text"] {
      flex: 0 0 60%;
    }
  </style>
</head>
<body>
<div class="toolList">
  <div class="toolOption">
    <span id="toggleUniquify" class="toggleButton">Uniquify</span>
    <div class="toolPanel _hide">
      <div class="flexElement">
        <label for="Unq-uniquifyInput">Input: <span id="inputCount"></span></label>
        <textarea id="Unq-uniquifyInput" wrap="off" style="overflow:scroll;"></textarea>
      </div>
      <div class="controlFlexContainer">
        <span class="controlOption">
          <input id="Unq-triggerUniquify" type="button" value="Uniquify ->">
        </span>
        <span class="controlOption">
          <label for="Unq-checkFilterEmpty">FilterEmpty</label>
          <input id="Unq-checkFilterEmpty" type="checkbox">
        </span>
        <span class="controlOption" style="flex-wrap:wrap !important;">
          <label for="Unq-sortDesc">Sort Description</label>
          <input id="Unq-sortDesc" type="text" />
          <br>
          <label for="Unq-checkSortByLength">Sort By Length</label>
          <input id="Unq-checkSortByLength" type="checkbox" name="Unq-sorts">
          <br>
          <label for="Unq-checkSortInNature">Sort By Nature</label>
          <input id="Unq-checkSortInNature" type="checkbox" name="Unq-sorts">
        </span>
      </div>
      <div class="flexElement">
        <label for="Unq-uniquifyOutput">Output: <span id="outputCount"></span></label>
        <textarea id="Unq-uniquifyOutput" wrap="off" style="overflow:scroll;"></textarea>
      </div>
    </div>
  </div>

  <div class="toolOption">
    <span id="toggleJoinSplit" class="toggleButton">Join & Split</span>
    <div class="toolPanel hide">
      <div class="flexElement">
        <label for="JS-joinSplitJoined">Joined</label>
        <textarea id="JS-joinSplitJoined" style="overflow:scroll;"></textarea>
      </div>
      <div class="controlFlexContainer">
        <span class="controlOption">
          <input id="JS-triggerSplitting" type="button" value="Split ->">
        </span>
        <hr>
        <span class="controlOption">
          <label for="JS-textSplitString">SplitString</label>
          <input id="JS-textSplitString" style="width: 30px;" type="text" />
        </span>
        <span class="controlOption">
          <label for="JS-Unq-checkFilterEmpty">FilterEmpty</label>
          <input id="JS-Unq-checkFilterEmpty" type="checkbox">
        </span>
        <span class="controlOption">
          <label for="JS-Unq-checkTrim">Trim</label>
          <input id="JS-Unq-checkTrim" type="checkbox">
        </span>
        <hr>
        <span class="controlOption">
          <input id="JS-triggerJoining" type="button" value="<- Join">
        </span>
        <span class="controlOption">
          <label for="JS-textDelimitString">DelimitString</label>
          <input id="JS-textDelimitString" style="width: 30px;" type="text" />
        </span>
      </div>
      <div class="flexElement">
        <label for="JS-joinSplitSplitted">Splitted</label>
        <textarea id="JS-joinSplitSplitted" style="overflow:scroll;"></textarea>
      </div>
    </div>
  </div>

</div>
<script>
  const lineWrapChar = String.fromCharCode(10);
  
  $(window).resize(function() {
    console.log('String-Window-resize');
    console.log($(window));
  });

  localStorage.setItem("1-1",1);

  // ******************** section toggle ********************

  const toggleButtons = $(".toggleButton");
  for(let i=0; i < toggleButtons.length; i++) {
    const toggleButton = $(toggleButtons[i]);
    toggleButton.click(e => {
      toggleButton.siblings(".toolpanel").toggleClass("hide");
    })
  }

  // ******************** uniquify panel ********************

  const uniquifyInput = $("#Unq-uniquifyInput");
  const uniquifyOutput = $("#Unq-uniquifyOutput");
  $("#Unq-triggerUniquify").click(e => {
    const inputText = uniquifyInput.val();
    let entryArr = inputText.split(lineWrapChar);
    $("#inputCount")[0].innerText = entryArr.length;
    entryArr = Array.from(new Set(entryArr));
    if ($("#Unq-checkFilterEmpty")[0].checked) {
      entryArr = entryArr.filter(item => !!item);
    }

    let sortFn = null;
    let sortArr = [];

    $("input[type='checkbox'][name=sorts]")
    if ($("#Unq-checkSortByLength")[0].checked) {

    }
    if ($("#Unq-checkSortInNature")[0].checked) {

    }


    if (sortFn) {
      entryArr = entryArr.sort(sortFn);
    }
    uniquifyOutput.val(entryArr.join(lineWrapChar));
    $("#outputCount")[0].innerText = entryArr.length;
  });

  // ******************** join / split panel ********************

  const joinSplitJoined = $("#JS-joinSplitJoined");
  const joinSplitSplitted = $("#JS-joinSplitSplitted");
  $("#JS-triggerSplitting").click(e => {
    const joinedText = joinSplitJoined.val();
    const splitString = $("#JS-textSplitString").val() || "";
    let splitArr = joinedText.split(splitString);
    let filterFn = null;
    let mapFn = null;
    if ($("#JS-Unq-checkFilterEmpty")[0].checked) {
      if (filterFn) {
        let tempFn = filterFn;
        filterFn = item => !!tempFn(item);
      } else {
        filterFn = item => !!item;
      }
    }
    if ($("#JS-Unq-checkTrim")[0].checked) {
      if (mapFn) {
        let tempFn = mapFn;
        mapFn = item => tempFn(item).trim();
      } else {
        mapFn = item => item.trim();
      }
    }
    if (mapFn) {
      splitArr = splitArr.map(mapFn);
    }
    if (filterFn) {
      splitArr = splitArr.filter(filterFn);
    }
    joinSplitSplitted.val(splitArr.join(lineWrapChar));
  });

  $("#JS-triggerJoining").click(e => {
    const splittedLines = joinSplitSplitted.val();
    const delimitString = $("#JS-textDelimitString").val() || "";
    const splitString = $("#JS-textSplitString").val() || "";
    let splitArr = splittedLines.split(lineWrapChar);
    let filterFn = null;
    let mapFn = null;
    if ($("#JS-Unq-checkFilterEmpty")[0].checked) {
      if (filterFn) {
        let tempFn = filterFn;
        filterFn = item => !!tempFn(item);
      } else {
        filterFn = item => !!item;
      }
    }
    if ($("#JS-Unq-checkTrim")[0].checked) {
      if (mapFn) {
        let tempFn = mapFn;
        mapFn = item => tempFn(item).trim();
      } else {
        mapFn = item => item.trim();
      }
    }
    if (delimitString) {
      if (mapFn) {
        let tempFn = mapFn;
        mapFn = item => `${delimitString}${tempFn(item)}${delimitString}`;
      } else {
        mapFn = item => `${delimitString}${item}${delimitString}`;
      }
    }
    if (mapFn) {
      splitArr = splitArr.map(mapFn);
    }
    if (filterFn) {
      splitArr = splitArr.filter(filterFn);
    }
    const joinedText = splitArr.join(splitString);
    joinSplitJoined.val(joinedText);
  });

</script>
</body>
</html>